CREATE TABLE IF NOT EXISTS airports (
    iata_code CHAR(3) PRIMARY KEY,
    name TEXT NOT NULL,
    city TEXT,
    state TEXT,
    country TEXT DEFAULT 'ARG',
    latitude DOUBLE PRECISION,
    longitude DOUBLE PRECISION
);

CREATE TABLE IF NOT EXISTS flights_calendar (
    id SERIAL PRIMARY KEY,
    available BOOLEAN DEFAULT TRUE,

    hash_id TEXT UNIQUE NOT NULL,
    flight_signature TEXT,

    provider VARCHAR(30),
    airline VARCHAR(30), 

    iata_origin CHAR(3) NOT NULL REFERENCES airports(iata_code) ON DELETE CASCADE,
    iata_destination CHAR(3) NOT NULL REFERENCES airports(iata_code) ON DELETE CASCADE,

    time_departure TIMESTAMP NOT NULL,
    time_arrival TIMESTAMP,

    scale BOOLEAN DEFAULT FALSE,
    price INTEGER,
    total_duration INTEGER,
    class VARCHAR(15),

    last_updated TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    UNIQUE (iata_origin, iata_destination, time_departure, class)
);

CREATE TABLE IF NOT EXISTS flight_sections (
    id SERIAL PRIMARY KEY,
    flight_hash TEXT NOT NULL REFERENCES flights_calendar(hash_id) ON DELETE CASCADE,

    section_index INTEGER NOT NULL,
    flight_number VARCHAR(10),
    
    departure TIMESTAMP,
    arrival TIMESTAMP,

    origin CHAR(3) REFERENCES airports(iata_code),
    destination CHAR(3) REFERENCES airports(iata_code),
    equipment VARCHAR(10),

    UNIQUE(flight_hash, section_index)
);

CREATE TABLE IF NOT EXISTS price_history_calendar (
    id SERIAL PRIMARY KEY,

    flight_hash TEXT NOT NULL REFERENCES flights_calendar(hash_id) ON DELETE CASCADE,

    iata_origin CHAR(3) NOT NULL,
    iata_destination CHAR(3) NOT NULL,
    time_departure TIMESTAMP NOT NULL,
    time_arrival TIMESTAMP NOT NULL,

    provider VARCHAR(30) NOT NULL,
    airline VARCHAR(30) NOT NULL,
    offer_class VARCHAR(20) NOT NULL,
    scale BOOLEAN DEFAULT FALSE,
    total_duration INTEGER,
    price INTEGER NOT NULL,

    recorded_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,

    UNIQUE (flight_hash, offer_class, price)
);

CREATE TABLE IF NOT EXISTS price_stats (
    iata_origin CHAR(3) NOT NULL,
    iata_destination CHAR(3) NOT NULL,
    period TEXT NOT NULL,
    offer_class VARCHAR(15) NOT NULL,

    sample_size INTEGER NOT NULL,
    median_price INTEGER NOT NULL,
    avg_price INTEGER NOT NULL,
    min_price INTEGER NOT NULL,
    max_price INTEGER NOT NULL,
    stddev_price FLOAT NOT NULL,
    q1 INTEGER NOT NULL,
    q3 INTEGER NOT NULL,
    iqr INTEGER NOT NULL,
    min_price_flight_hash TEXT REFERENCES flights_calendar(hash_id),

    last_updated TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,

    PRIMARY KEY (iata_origin, iata_destination, period, offer_class)
);

CREATE TABLE IF NOT EXISTS notifications_sent (
    id SERIAL PRIMARY KEY,
    flight_hash TEXT NOT NULL REFERENCES flights_calendar(hash_id),
    price INTEGER NOT NULL,
    notified_channel TEXT NOT NULL,
    sent_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,

    UNIQUE(flight_hash, price, notified_channel)
);



CREATE INDEX IF NOT EXISTS idx_calendar_prices_month ON flights_calendar (
    iata_origin, iata_destination, class,
    date_trunc('month', time_departure)
);
CREATE INDEX IF NOT EXISTS idx_notifications_sent_time
ON notifications_sent(sent_at DESC);


--- Data Airports ---
INSERT INTO airports (iata_code, name, city, state, country, latitude, longitude) VALUES
('BHI', 'Comandante Espora', 'Bahía Blanca', 'Buenos Aires', 'ARG', -38.720278, -62.157500),
('AEP', 'Aeroparque Jorge Newbery', 'Buenos Aires', 'Buenos Aires', 'ARG', -34.558889, -58.416389),
('EZE', 'Ministro Pistarini - Ezeiza', 'Buenos Aires', 'Buenos Aires', 'ARG', -34.822222, -58.535833),
('MDQ', 'Astor Piazzola', 'Mar Del Plata', 'Buenos Aires', 'ARG', -37.934167, -57.573611),
('CTC', 'Catamarca', 'Catamarca', 'Catamarca', 'ARG', -28.593056, -65.750833),
('RES', 'Resistencia', 'Resistencia', 'Chaco', 'ARG', -27.450000, -59.056111),
('CRD', 'General E. Mosconi', 'Comodoro Rivadavia', 'Chubut', 'ARG', -45.785278, -67.465556),
('EQS', 'Esquel', 'Esquel', 'Chubut', 'ARG', -42.906722, -71.146667),
('REL', 'Almirante M.A. Zar', 'Trelew', 'Chubut', 'ARG', -43.209778, -65.283806),
('COR', 'A.L.V. Taravella', 'Córdoba', 'Córdoba', 'ARG', -31.310000, -64.208333),
('RCU', 'Las Higueras', 'Rio Cuarto', 'Córdoba', 'ARG', -33.085278, -64.261389),
('CNQ', 'Corrientes', 'Corrientes', 'Corrientes', 'ARG', -27.445556, -58.761944),
('FMA', 'Formosa', 'Formosa', 'Formosa', 'ARG', -26.212778, -58.228056),
('JUJ', 'Gobernador H. Guzman', 'Jujuy', 'Jujuy', 'ARG', -24.392500, -65.097778),
('RSA', 'Santa Rosa', 'Santa Rosa', 'Pampa', 'ARG', -36.588333, -64.275833),
('IRJ', 'Capitán V.A. Almonacid ', 'La Rioja', 'La Rioja', 'ARG', -29.380556, -66.795833),
('AFA', 'San Rafael', 'San Rafael', 'Mendoza', 'ARG', -34.587817, -68.403589),
('MDZ', 'El Plumerillo', 'Mendoza', 'Mendoza', 'ARG', -32.831667, -68.792778),
('IGR', 'Cataratas del Iguazu', 'Iguazu', 'Misiones', 'ARG', -25.736111, -54.473611),
('PSS', 'Jose de San Martin', 'Posadas', 'Misiones', 'ARG', -27.385730, -55.970490),
('CPC', 'Aviador Carlos Campos', 'San Martin de los Andes', 'Neuquén', 'ARG', -40.075278, -71.137222),
('NQN', 'Presidente Peron', 'Neuquén', 'Neuquén', 'ARG', -38.951370, -68.140570),
('BRC', 'San Carlos Bariloche', 'Bariloche', 'Rio Negro', 'ARG', -41.151111, -71.157500),
('VDM', 'Gobernador E. Castello', 'Viedma', 'Rio Negro', 'ARG', -40.869444, -63.000000),
('SLA', 'Martin M. de Guemes', 'Salta', 'Salta', 'ARG', -24.859722, -65.486944),
('UAQ', 'Domingo F. Sarmiento', 'San Juan', 'San Juan', 'ARG', -31.571389, -68.418333),
('FTE', 'Comandante A. Tola', 'El Calafate', 'Santa Cruz', 'ARG', -50.280250, -72.053194),
('RGL', 'Piloto N. Fernandez', 'Río Gallegos', 'Santa Cruz', 'ARG', -51.608810, -69.312170),
('ROS', 'Islas Malvinas', 'Rosario', 'Santa Fe', 'ARG', -32.903611, -60.784444),
('SFN', 'Sauce Viejo', 'Santa Fe', 'Santa Fe', 'ARG', -31.710833, -60.811389),
('RHD', 'Termas de Rio Hondo', 'Rio Hondo', 'Santiago Del Estero', 'ARG', -27.497222, -64.936111),
('SDE', 'A. de la Paz Aragonez', 'Santiago Del Estero', 'Santiago Del Estero', 'ARG', -27.766667, -64.309722),
('RGA', 'Hermes Quijada', 'Rio Grande', 'Tierra del Fuego', 'ARG', -53.777600, -67.749520),
('USH', 'Malvinas Argentinas', 'Ushuaia', 'Tierra del Fuego', 'ARG', -54.843333, -68.294444),
('TUC', 'Benjamin Matienzo', 'Tucuman', 'Tucumán', 'ARG', -26.840833, -65.104722),
('PRA', 'Parana', 'Parana', 'Entre Rios', 'ARG', -31.794722, -60.480278),
('RCQ', 'Aeropuerto Teniente Daniel Jukic', 'Reconquista', 'Santa Fe', 'ARG', -29.210278, -59.680000),
('LUQ', 'Brigadier Mayor Ojeda Aeropuerto de San Luis ', 'San Luis', 'San Luis', 'ARG', -33.275000, -66.351111),
('PMY', 'Aeropuerto de Puerto Madryn El Tehuelche', 'Puerto Madryn', 'Chubut', 'ARG', -42.758333, -65.101389),
('RLO', 'Aeropuerto Internacional Valle de Conlara en Merlo', 'Merlo', 'San Luis', 'ARG', -32.384445, -65.185833),
('TIA', 'Nene Tereza Internacional', 'Tirana', '', 'ALB', 41.4146995544, 19.7206001282),
('ADL', 'Adelaida', 'Adelaida', 'South Australia', 'AUS', -34.9449996948, 138.5310058594),
('BNE', 'Brisbane', 'Brisbane', 'Queensland', 'AUS', -27.3841991425, 153.1170043945),
('CNS', 'Cairns', 'Cairns', 'Queensland', 'AUS', -16.885799408, 145.755004883),
('MEL', 'Tullamarine', 'Melbourne', 'Victoria', 'AUS', -37.6733016968, 144.8430023193),
('OOL', 'Coolangatta', 'Gold Coast', 'Queensland', 'AUS', -28.1644001007, 153.505004883),
('PER', 'Perth', 'Perth', 'Western Australia', 'AUS', -31.9402999878, 115.9670028687),
('SYD', 'Kingsford Smith', 'Sydney', 'New South Wales', 'AUS', -33.9460983276, 151.1770019531),
('BRU', 'Bruselas', 'Bruselas', 'Flanders', 'BEL', 50.9014015198, 4.4844398499),
('SOF', 'Sofia', 'Sofía', 'Sofia-Capital', 'BGR', 42.6966934204, 23.4114360809),
('CBB', 'Jorge Wilstermann Internacional', 'Cochabamba', 'Cochabamba', 'BOL', -17.4211006165, -66.1771011353),
('LPB', 'El Alto Internacional', 'La Paz', 'La-Paz', 'BOL', -16.513299942, -68.1922988892),
('SRE', 'Alcantari', 'Sucre', 'Chuquisaca', 'BOL', -19.24627, -65.15104),
('SRZ', 'El Trompillo', 'Santa Cruz', 'Santa-Cruz', 'BOL', -17.8115997314, -63.1715011597),
('UYU', 'Uyuni', 'Uyuni', 'Potosi', 'BOL', -20.4463005066, -66.8483963013),
('RBQ', 'Rurrenabaque', 'Rurrenabaque', 'El-Beni', 'BOL', -14.4279003143, -67.4968032837),
('BPS', 'Porto Seguro', 'Porto Seguro', 'Bahia', 'BRA', -16.4386005402, -39.0808982849),
('JOI', 'Lauro Carneiro Loyola', 'Joinville', 'Santa-Catarina', 'BRA', -26.2245006561, -48.7974014282),
('XAP', 'Serafin Enoss Bertaso', 'Chapecó', 'Santa-Catarina', 'BRA', -27.1341991425, -52.6566009521),
('CPV', 'Joao Suassuna', 'Campina Grande', 'Paraiba', 'BRA', -7.2699198723, -35.8964004517),
('CZS', 'Cruzeiro Do Sul', 'Cruzeiro Do Sul', 'Acre', 'BRA', -7.5999097824, -72.7695007324),
('JDO', 'O. Bezerra de Menezes', 'Juazeiro Do Norte', 'Ceara', 'BRA', -7.2189598084, -39.2700996399),
('PNZ', 'Senador Nilo Coelho', 'Petrolina', 'Pernambuco', 'BRA', -9.3624095917, -40.5690994263),
('AJU', 'Santa Maria', 'Aracaju', 'Sergipe', 'BRA', -10.984000206, -37.0703010559),
('BEL', 'Val de Cans Internacional', 'Belém', 'Para', 'BRA', -1.3792500496, -48.4762992859),
('BHZ', 'Belo Horizonte', 'Belo Horizonte', 'State Not Found', 'BRA', -19.624444, -43.971944),
('BSB', 'J. Kubitschek Internacional', 'Brasilia', 'Federal-District', 'BRA', -15.8691673279, -47.9208335876),
('ATL', 'Hartsfield-Jackson Internacional', 'Atlanta', 'Georgia', 'USA', 33.6366996765, -84.4281005859),
('ORD', 'O Hare International', 'Chicago', 'Illinois', 'USA', 41.97859955, -87.90480042),
('DTT', 'Detroit', 'Detroit', 'State Not Found', 'USA', 42.4112358,-83.00852132166864),
('LAX', 'Los Angeles', 'Los Ángeles', 'California', 'USA', 33.94250107, -118.4079971),
('MEM', 'Memphis', 'Menfis', 'Tennessee', 'USA', 35.0424003601, -89.9766998291),
('MIA', 'Miami', 'Miami', 'Florida', 'USA', 25.7931995392, -80.2906036377),
('MSP', 'Mineápolis', 'Minneapolis', 'Minnesota', 'USA', 44.8819999695, -93.2218017578),
('JFK', 'John F Kennedy Internacional', 'Nueva York', 'New York', 'USA', 40.63980103, -73.77890015),
('WAS', 'Washington', 'Washington', 'State Not Found', 'USA', 38.85761745860855, -77.03997940302476),
('BOS', 'Edward L. Logan Internacional', 'Boston', 'Massachusetts', 'USA', 42.36429977, -71.00520325),
('VCP', 'Viracopos-Campinas Internacional', 'São Paulo', 'Sao Paulo', 'BRA', -23.0074005127, -47.1344985962),
('FCO', 'Roma', 'Roma', 'Latium', 'ITA', 41.8045005798, 12.2508001328),
('GIG', 'Río de Janeiro', 'Río De Janeiro', 'Rio-de-Janeiro', 'BRA', -22.8099994659, -43.2505569458),
('ASU', 'Asunción', 'Asunción', 'Central', 'PRY', -25.2399997711, -57.5200004578),
('BCN', 'Barcelona', 'Barcelona', 'Catalonia', 'ESP', 41.2971000671, 2.0784599781),
('CNF', 'Belo Horizonte', 'Belo Horizonte', 'Minas Gerais', 'BRA', -19.6244430542, -43.9719429016),
('BOG', 'Bogotá', 'Bogotá', 'Bogota-D-C-', 'COL', 4.70159, -74.1469),
('CUN', 'Cancún', 'Cancún', 'Quintana-Roo', 'MEX', 21.0365009308, -86.8770980835),
('CCS', 'Caracas', 'Caracas', 'Vargas', 'VEN', 10.6031169891, -66.9905853271),
('CWB', 'Curitiba', 'Curitiba', 'Parana', 'BRA', -25.5284996033, -49.1758003235),
('LIM', 'Lima', 'Lima', 'Callao', 'PER', -12.021900177, -77.1143035889),
('MAD', 'Barajas', 'Madrid', 'Madrid', 'ESP', 40.4936, -3.56676),
('MVD', 'Montevideo', 'Montevideo', 'Canelones', 'URY', -34.8384017944, -56.0307998657),
('POA', 'Puerto Alegre', 'Puerto Alegre', 'Rio-Grande-do-Sul', 'BRA', -29.9944000244, -51.1713981628),
('PDP', 'Punta Del Este', 'Punta Del Este', 'Maldonado', 'URY', -34.8550987244, -55.0942993164),
('GRU', 'São Paulo', 'San Pablo', 'Sao Paulo', 'BRA', -23.4355564117, -46.4730567932),
('VVI', 'Santa Cruz de la Sierra', 'Santa Cruz', 'Santa-Cruz', 'BOL', -17.6448001862, -63.1353988647),
('SCL', 'Santiago de Chile', 'Santiago', 'Santiago Metropolitan Region', 'CHL', -33.3930015564, -70.7857971191),
('CDG', 'Aeropuerto Internacional de París-Charles de Gaulle', 'París', 'Ile-de-France', 'FRA', 49.0127983093, 2.5499999523),
('AGP', 'Aeropuerto de Málaga - Costa del Sol', 'Málaga', 'Andalusia', 'ESP', 36.6749000549, -4.4991102219),
('ALC', 'Aeropuerto de Alicante-Elche', 'Alicante', 'Valencia', 'ESP', 38.2821998596, -0.5581560135),
('SVQ', 'Aeropuerto de Sevilla', 'Sevilla', 'Andalusia', 'ESP', 37.4179992676, -5.8931097984),
('TFN', 'Aeropuerto de Tenerife Norte', 'Tenerife', 'Canary-Islands', 'ESP', 28.4827003479, -16.3414993286),
('CTA', 'Aeropuerto de Catania - Fontanarossa', 'Catania', 'Sicily', 'ITA', 37.4668006897, 15.0663995743),
('MCO', 'Aeropuerto Internacional de Orlando', 'Orlando', 'Florida', 'USA', 28.4293994904, -81.3089981079),
('SSA', 'Aeropuerto Internacional Diputado Luís Eduardo Magalhães', 'Salvador', 'Bahia', 'BRA', -12.068355039634072, -45.7114544107571),
('UIO', 'Aeropuerto Internacional Mariscal Sucre', 'Quito', 'Pichincha', 'ECU', -0.1291666667, -78.3575),
('AKL', 'Auckland', 'Auckland', 'Auckland', 'NZL', -37.0080986023, 174.7920074463),
('PAR', 'Paris', 'París', 'State Not Found', 'FRA', 48.96895233254682, 2.4359057257948193),
('LGA', 'Aeropuerto Internacional de La Guardia', 'Nueva York', 'New York', 'USA', 40.77719879, -73.87259674),
('NYC', 'Nueva York', 'Nueva York', 'State Not Found', 'USA', 40.7800330237541, -73.87102780425474),
('RIO', 'Metropolitan Area', 'Río De Janeiro', 'State Not Found', 'BRA', -22.802145082785835, -43.25974123789904),
('MDW', 'Midway Airport', 'Chicago', 'Illinois', 'USA', 41.7859992981, -87.7524032593),
('LDB', 'El Alto Airport', 'Londrina', 'Parana', 'BRA', -23.3335990906, -51.1301002502),
('IAH', 'George Bush Intercontinental Airport', 'Houston', 'Texas', 'USA', 29.9843997955, -95.3414001465),
('LCG', 'A Coruna Airport', 'La Coruna', 'Galicia', 'ESP', 43.3021011353, -8.3772602081),
('DCA', 'Ronald Reagan National Airport', 'Washington', 'Virginia', 'USA', 38.8521003723, -77.0376968384),
('IAD', 'Dulles International Airport', 'Washington', 'Virginia', 'USA', 38.94449997, -77.45580292),
('PHX', 'Sky Harbor International Airport', 'Phoenix', 'Arizona', 'USA', 33.434299469, -112.0120010376),
('CGH', 'Congonhas Airport', 'São Paulo', 'Sao Paulo', 'BRA', -23.6261100769, -46.6563873291),
('SDU', 'Santos Dumont Airport', 'Río De Janeiro', 'Rio-de-Janeiro', 'BRA', -22.9104995728, -43.1631011963),
('TFS', 'Tenerife-Sur', 'Tenerife', 'Canary-Islands', 'ESP', 28.044500351, -16.5725002289),
('LGW', 'Gatwick Airport', 'Londres', 'England', 'GBR', 51.1481018066, -0.1902779937),
('LHR', 'Heathrow Airport', 'Londres', 'England', 'GBR', 51.4706001282, -0.4619410038),
('SPU', 'Split Airport', 'Split', 'Split-Dalmatia', 'HRV', 43.538898468, 16.2980003357),
('BGY', 'Bergamo/Orio al Serio Airport', 'Milán', 'Lombardy', 'ITA', 45.6739006042, 9.7041702271),
('LIN', 'Linate Airport', 'Milán', 'Lombardy', 'ITA', 45.445098877, 9.2767400742),
('MXP', 'Malpensa Airport', 'Milán', 'Lombardy', 'ITA', 45.6305999756, 8.7281103134),
('CPH', 'Kastrup Airport', 'Copenhagen', 'Capital-Region', 'DNK', 55.6179008484, 12.6560001373),
('OTP', 'Otopeni International Airport', 'Bucarest', 'Ilfov', 'ROU', 44.5722007751, 26.1021995544),
('GOJ', 'Strigino Airport', 'Nizhniy Novgorod', 'Novgorod', 'RUS', 56.2300987244, 43.7840003967),
('KBP', 'Boryspil International-Airport', 'Kiev', 'Kyiv', 'UKR', 50.3450012207, 30.8946990967),
('SVO', 'Sheremetyevo Airport', 'Moscú', 'Moscow-Oblast', 'RUS', 55.9725990295, 37.4146003723),
('PEK', 'Capital Airport', 'Pekín', 'Beijing', 'CHN', 40.0801010132, 116.5849990845),
('XIY', 'Xianyang Airport', 'Xi an', 'Shaanxi', 'CHN', 34.447101593, 108.7519989014),
('DOH', 'Doha International Airport', 'Doha', 'Baladiyat-ad-Dawḩah', 'QAT', 25.2605946, 51.6137665),
('AMD', 'Ahmedabad Airport', 'Ahmedabad', 'Gujarat', 'QAT', 23.0771999359, 72.6346969604),
('BLR', 'Hindustan Interntional Airport', 'Bangalore', 'Karnataka', 'IND', 13.1978998184, 77.7062988281),
('BOM', 'Mumbai Airport', 'Bombay', 'Maharashtra', 'IND', 19.0886993408, 72.8678970337),
('CCU', 'Netaji Subhas Chandra Airport', 'Kolkata', 'West-Bengal', 'IND', 22.6546993256, 88.4467010498),
('MAA', 'Chennai Airport', 'Chennai', 'Tamil-Nadu', 'IND', 12.9900054932, 80.1692962646),
('COK', 'Kochi Airport', 'Kochi', 'Kerala', 'IND', 10.1520004272, 76.4019012451),
('HYD', 'Rajiv Gandhi International Airport', 'Hyderabad', 'Telangana', 'IND', 17.2313175201, 78.4298553467),
('CCJ', 'Calicut Airport', 'Kozhikode', 'Kerala', 'IND', 11.1367998123, 75.9552993774),
('TRV', 'Trivandrum International Airport', 'Thiruvananthapuram', 'Kerala', 'IND', 8.4821195602, 76.9200973511),
('ICN', 'Incheon International Airport', 'Seúl', 'Incheon', 'KOR', 37.4691009521, 126.4509963989),
('CMN', 'Mohammed V Airport', 'Casablanca', '', 'MAR', 33.3675003052, -7.5899701118),
('CTU', 'Chengdu Airport', 'Chengdu', 'Sichuan', 'CHN', 30.5785007477, 103.9469985962),
('PVG', 'PuDong Airport', 'Shanghai', 'Shanghai', 'CHN', 31.1434001923, 121.8050003052),
('SIA', 'Xiguan Airport', 'Xi an', 'Shaanxi', 'CHN', 34.376701355, 109.1200027466),
('SAO', 'Metropolitan Area', 'São Paulo', 'Sao Paulo', 'BRA', -23.5090999603, -46.6377983093),
('HAV', 'La Habana', 'La Habana', 'La-Habana', 'CUB', 22.989200592, -82.4091033936),
('BVB', 'Boa Vista Airport', 'Boa Vista', 'Roraima', 'BRA', 2.8413889408, -60.6922225952),
('CXJ', 'Campo Dos Bugres Airport', 'Caxias Do Sul', 'Rio-Grande-do-Sul', 'BRA', -29.1970996857, -51.1875),
('MCP', 'Macapa Internacional Airport', 'Macapa', 'Amapa', 'BRA', 0.0506640002, -51.0722007751),
('PPB', 'A. De Barros Airport', 'Presidente Prudente', 'Sao Paulo', 'BRA', -22.1751003265, -51.4245986938),
('JJD', 'Jericoacoara', 'Jericoacoara', 'Ceara', 'BRA', -2.906667, -40.358056),
('AHO', 'Aeropuerto de Alguer-Fertilia', 'Alguer', 'Sardinia', 'ITA', 40.6320991516, 8.290769577),
('BRI', 'Aeropuerto de Bari-Palese', 'Bari', 'Apulia', 'ITA', 41.1389007568, 16.7605991364),
('BDS', 'Brindisi - Aeropuerto del Salento', 'Brindisi', 'Apulia', 'ITA', 40.6576004028, 17.9470005035),
('BLQ', 'Aeropuerto de Bologna', 'Bolonia', 'Emilia-Romagna', 'ITA', 44.5354003906, 11.2887001038),
('CAG', 'Aeropuerto de Cagliari-Elmas', 'Cagliari', 'Sardinia', 'ITA', 39.251499176, 9.0542802811),
('NCE', 'Aeropuerto Internacional Niza Costa Azul', 'Niza', 'Provence-Alpes-Cote-d Azur', 'FRA', 43.6584014893, 7.2158699036),
('ZRH', 'Aeropuerto de Zurich', 'Zúrich', 'Zurich', 'CHE', 47.4646987915, 8.5491695404),
('REG', 'Aeropuerto de Reggio di Calabria', 'Reggio Calabria', 'Calabria', 'ITA', 38.0712013245, 15.651599884),
('FLR', 'Aeropuerto de Florencia', 'Florencia', 'Tuscany', 'ITA', 43.8100013733, 11.2051000595),
('GOA', 'Aeropuerto de Génova', 'Genova', 'Liguria', 'ITA', 44.4132995605, 8.8374996185),
('SUF', 'Aeropuerto Internacional de Lamezia Terme', 'Lamezia Terme', 'Calabria', 'ITA', 38.9053993225, 16.2423000336),
('NAP', 'Aeropuerto de Nápoles ', 'Nápoles', 'Campania', 'ITA', 40.8860015869, 14.2908000946),
('PMO', 'Aeropuerto de Palermo', 'Palermo', 'Sicily', 'ITA', 38.1759986877, 13.0909996033),
('TUN', 'Aeropuerto Internacional de Túnez', 'Tunez', 'Tunis', 'TUN', 36.8510017395, 10.2271995544),
('MUC', 'Aeropuerto Internacional de Múnich', 'Múnich', 'Bavaria', 'DEU', 48.3538017273, 11.7861003876),
('TRS', 'Aeropuerto de Trieste - Friuli Venezia Giulia', 'Trieste', 'Friuli-Venezia-Giulia', 'ITA', 45.8274993896, 13.4722003937),
('TRN', 'Aeropuerto de Turín-Caselle', 'Turín', 'Piedmont', 'ITA', 45.2008018494, 7.6496300697),
('VRN', 'Aeropuerto de Verona - Villafranca', 'Verona', 'Veneto', 'ITA', 45.3956985474, 10.8885002136),
('VCE', 'Aeropuerto Internacional Marco Polo', 'Venecia', 'Veneto', 'ITA', 45.5052986145, 12.3519001007),
('AMS', 'Aeropuerto de Ámsterdam-Schiphol', 'Amsterdam', 'North-Holland', 'NLD', 52.3086013794, 4.7638897896),
('GVA', 'Aeropuerto Internacional de Ginebra', 'Ginebra', 'Geneva', 'CHE', 46.2380981445, 6.1089501381),
('JED', 'Aeropuerto Internacional Rey Abdulaziz', 'Jeddah', 'Makkah', 'SAU', 21.679599762, 39.15650177),
('RUH', 'Aeropuerto Internacional Rey Khalid', 'Riyadh', '', 'SAU', 24.9575996399, 46.6987991333),
('FLN', 'Hercílio Luz Aeropuerto Internacional de Florianópolis', 'Florianopolis', 'Santa-Catarina', 'BRA', -27.6702785492, -48.5525016785),
('PUJ', 'Aeropuerto Internacional de Punta Cana', 'Punta Cana', 'La-Altagracia', 'DOM', 18.5673999786, -68.3634033203),
('SHA', 'Shanghai', 'Shanghai', 'Shanghai', 'CHN', 31.1979007721, 121.3359985352),
('PIU', 'Capitan FAP Guillermo Concha Iberico International Airport', 'Piura', 'Piura', 'PER', -5.2057499886, -80.6164016724),
('TRU', 'Capitan FAP Carlos Martinez De Pinillos International Airport', 'Trujillo', 'La-Libertad', 'PER', -8.081410408, -79.1088027954),
('JUL', 'Inca Manco Capac International Airport', 'Juliaca', 'Puno', 'PER', -15.4671001434, -70.158203125),
('AYP', 'Coronel FAP Alfredo Mendivil Duarte Airport', 'Ayacucho', 'Ayacucho', 'PER', -13.154800415, -74.2043991089),
('TBP', 'Capitan FAP Pedro Canga Rodriguez Airport', 'Tumbes', 'Tumbes', 'PER', -3.5525300503, -80.381401062),
('CUZ', 'Alejandro Velasco Astete International Airport', 'Cusco', 'Cusco', 'PER', -13.5356998444, -71.9387969971),
('AQP', 'Rodriguez Ballon International Airport', 'Arequipa', 'Arequipa', 'PER', -16.3411006927, -71.5830993652),
('IQT', 'Coronel FAP Francisco Secada Vignetta International Airport', 'Iquitos', 'Loreto', 'PER', -3.7847399712, -73.3087997437),
('TPP', 'Cadete FAP Guillermo Del Castillo Paredes Airport', 'Tarapoto', 'San-Martin', 'PER', -6.5087399483, -76.3731994629),
('ANF', 'Aeropuerto Internacional de Antofagasta', 'Antofagasta', 'Antofagasta', 'CHL', -23.4444999695, -70.445098877),
('CPO', 'Aeropuerto Desierto de Atacama', 'Copiapó', 'Atacama', 'CHL', -27.2611999512, -70.7791976929),
('LSC', 'Aeropuerto La Serena - La Florida', 'La Serena', 'Coquimbo', 'CHL', -29.9162006378, -71.1995010376),
('PCL', 'Cap FAP David Abenzur Rengifo International Airport', 'Pucallpa', 'Ucayali', 'PER', -8.3779401779, -74.5743026733),
('IQQ', 'Aeropuerto Internacional Diego Aracena', 'Iquique', 'Tarapaca', 'CHL', -20.535200119, -70.1812973022),
('JAU', 'Francisco Carle Airport', 'Jauja', 'Junin', 'PER', -11.7831001282, -75.4733963013),
('ARI', 'Aeropuerto Internacional Chacalluta', 'Arica', 'Arica-y-Parinacota', 'CHL', -18.3484992981, -70.3386993408),
('CJC', 'Aeropuerto El Loa', 'Calama', 'Antofagasta', 'CHL', -22.4981994629, -68.9036026001),
('CCP', 'Aeropuerto Internacional Concepción Carriel Sur ', 'Concepción', 'Biobio', 'CHL', -36.7727012634, -73.0631027222),
('ZCO', 'Aeropuerto Temuco', 'Temuco', 'Araucania', 'CHL', -38.7667999268, -72.6371002197),
('BBA', 'Aeropuerto Balmaceda', 'Balmaceda', 'Aisen', 'CHL', -45.9160995483, -71.6894989014),
('ZAL', 'Aeropuerto Valdivia Pichoy', 'Valdivia', 'Los-Rios', 'CHL', -39.6500015259, -73.0860977173),
('ZOS', 'Aeropuerto Osorno', 'Osorno', 'Los-Lagos', 'CHL', -40.6111984253, -73.0609970093),
('PMC', 'Aeropuerto Puerto Montt El Tepual', 'Puerto Montt', 'Los-Lagos', 'CHL', -41.4388999939, -73.09400177),
('PNT', 'Aeropuerto Teniente Julio Gallardo', 'Puerto Natales', 'Magallanes', 'CHL', -51.6715011597, -72.5283966064),
('PUQ', 'Aeropuerto Internacional Punta Arenas', 'Punta Arenas', 'Magallanes', 'CHL', -53.0026016235, -70.854598999),
('MHC', 'Aeropuerto Castro Mocopulli', 'Castro Mocopulli', 'Los Lagos Region', 'CHL', -42.340278, -73.715556),
('ARN', 'Stockholm Arlanda', 'Estocolmo', 'Stockholm', 'SWE', 59.6519012451, 17.9186000824),
('DXB', 'Aeropuerto Internacional de Dubai', 'Dubai', 'Dubai', 'ARE', 25.2527999878, 55.3643989563),
('LUX', 'Luxemburgo', 'Luxemburgo', 'Luxembourg', 'LUX', 49.6265983582, 6.211520195),
('FOR', 'Fortaleza', 'Fortaleza', 'Ceara', 'BRA', -3.7762799263, -38.5326004028),
('YJM', 'Estacion Malaga Maria Zambrano', 'Málaga', 'British Columbia', 'ESP', 54.3972015381, -124.2630004883),
('QLP', 'La Spezia', 'La Spezia', 'State Not Found', 'ITA', 44.090300506776984, 9.991295328820692),
('QPA', 'Padova', 'Padova', 'Veneto', 'ITA', 45.3958015442, 11.8479003906),
('RRN', 'Boca Raton', 'Boca Raton', 'State Not Found', 'USA', -6.114337117327711, -50.00105000493403),
('MJV', 'Estacion Murcia Del Carmen', 'Murcia', 'Murcia', 'ESP', 37.7750015259, -0.8123890162),
('CIX', 'Aeropuerto Internacional José A. Quiñones', 'Chiclayo', 'Lambayeque', 'PER', -6.7874798775, -79.8281021118),
('MIL', 'MIL', 'Milán', 'State Not Found', 'ITA', 45.45342811121323, 9.276425672295165),
('TYL', 'Aeropuerto Internacional Capitán Víctor Montes Arias', 'Talara', 'Piura', 'PER', -4.5766401291, -81.2540969849),
('ATA', 'Aeropuerto Comandante Germán Arias Graziani', 'Huaraz', 'Ancash', 'PER', -9.3474397659, -77.5983963013),
('CJA', 'Aeropuerto Internacional Armando Revoredo Iglesias', 'Cajamarca', 'Cajamarca', 'PER', -7.1391801834, -78.489402771),
('FEN', 'Aeropuerto de Fernando de Noronha', 'Fernando Noronha', 'Pernambuco', 'BRA', -3.854929924, -32.4233016968),
('OPS', 'Aeropuerto de Sinop', 'Sinop', 'Mato Grosso', 'BRA', -11.8850002289, -55.5861091614),
('LCY', 'London City ', 'Londres', 'England', 'GBR', 51.5052986145, 0.0552779995),
('VDC', 'Aeropuerto Glauber Rocha ', 'Vitória da Conquista', 'Bahia', 'BRA', -14.8627996445, -40.8630981445),
('OSL', 'Aeropuerto de Oslo-Gardermoen', 'Oslo', 'Akershus', 'NOR', 60.193901062, 11.100399971),
('GLA', 'Aeropuerto Internacional de Glasgow', 'Glasgow', 'Scotland', 'NOR', 55.8718986511, -4.4330601692),
('EDI', 'Aeropuerto de Edimburgo', 'Edimburgo', 'Scotland', 'GBR', 55.9500007629, -3.3724999428),
('NAS', 'Aeropuerto Internacional Lynden Pindling', 'NASSAU', 'New-Providence', 'BHS', 25.0389995575, -77.4662017822);
